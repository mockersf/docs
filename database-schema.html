<!DOCTYPE html>
<html>
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60508041-1"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-60508041-1');
</script>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=775" />
<title>Database Schema - Concourse CI</title>
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/pipeline.css" />
<link rel="stylesheet" type="text/css" href="css/iosevka.css" />
<link rel="stylesheet" type="text/css" href="css/booklit.css" />
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700|Roboto+Slab:300,400,700" rel="stylesheet" />
<script src="js/search.js"></script>
  </head>
  <body>
    <div class="top-logo">
  <a href="/">Concourse</a>
</div>

<nav class="top-nav">
  
  <a href="docs.html">Docs</a>
  
  <a href="download.html">Download</a>
  
  <a href="project.html" class="active">Project</a>
  
  <a href="community.html">Community</a>
  
  <a href="learning.html">Learning</a>
  
</nav>

<div class="top-search">
  <div id="search"></div>
</div>

<script type="text/javascript">
  Elm.Main.init({
    node: document.getElementById('search')
  });
</script>

    <div class="page-nav">
      







  
  
  
  
  

  
  <div class="context">
    <nav>
      <div class="top">
        
        <span class="section-number">3</span>
        
        
  <a href="project.html"  class="active">Project</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="right">3.1&nbsp;</td>
            
            <td class="title-cell">
  <a href="contribute.html" >Contribute</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2&nbsp;</td>
            
            <td class="title-cell">
  <a href="architecture.html"  class="active">Architecture</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.3&nbsp;</td>
            
            <td class="title-cell">
  <a href="thanks.html" >Thanks!</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.4&nbsp;</td>
            
            <td class="title-cell">
  <a href="trademarks.html" >Trademarks</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  

  

  
  <div class="context">
    <nav>
      <div class="top">
        
        <span class="section-number">3.2</span>
        
        
  <a href="architecture.html"  class="active">Architecture</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="left"></td>
            
            <td class="title-cell">
  <a href="architecture.html#component-atc" >ATC: web UI &amp; build scheduler</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="left"></td>
            
            <td class="title-cell">
  <a href="architecture.html#component-tsa" >TSA: worker registration &amp; forwarding</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="left"></td>
            
            <td class="title-cell">
  <a href="architecture.html#architecture-worker" >Workers: container runtime &amp; cache management</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="left"></td>
            
            <td class="title-cell">
  <a href="architecture.html#internals"  class="active">Internals</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  

  

  
  <div class="context">
    <nav>
      <div class="top">
        
        
  <a href="architecture.html#internals"  class="active">Internals</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.1&nbsp;</td>
            
            <td class="title-cell">
  <a href="database-schema.html"  class="self">Database Schema</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.2&nbsp;</td>
            
            <td class="title-cell">
  <a href="garbage-collection.html" >Garbage Collection</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.3&nbsp;</td>
            
            <td class="title-cell">
  <a href="volume-internals.html" >Volumes</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.4&nbsp;</td>
            
            <td class="title-cell">
  <a href="container-internals.html" >Containers</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.5&nbsp;</td>
            
            <td class="title-cell">
  <a href="worker-internals.html" >Workers</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">3.2.4.6&nbsp;</td>
            
            <td class="title-cell">
  <a href="caching-and-retention.html" >Caching &amp; Retention</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  





<div class="context">
  <div class="page-toc">
    <nav>
      <div class="top">
        
        <span class="section-number">3.2.4.1</span>
        
        
  <a href="database-schema.html"  class="self">Database Schema</a>

      </div>

      
<div class="children">
  <table>
    
      <tr>
        
          <td class="number-cell" align="left"></td>
        
        <td class="title-cell">
          <a href="database-schema.html#pipelineapi-objects">Pipeline/API Objects</a>

          
        </td>
      </tr>
    
      <tr>
        
          <td class="number-cell" align="left"></td>
        
        <td class="title-cell">
          <a href="database-schema.html#abstract-objects">Abstract Objects</a>

          
        </td>
      </tr>
    
      <tr>
        
          <td class="number-cell" align="left"></td>
        
        <td class="title-cell">
          <a href="database-schema.html#runtime">Runtime</a>

          
        </td>
      </tr>
    
  </table>
</div>

    </nav>
  </div>
</div>




<div class="context">
  <div class="Top">
    On this page:
  </div>

  <div class="children anchors">
    <table>
      

      
  
    
      
        <tr>
          <td class="number-cell" align="left">3.2.4.1.1&nbsp;</td>
          <td class="title-cell">
  <a href="database-schema.html#pipelineapi-objects" >Pipeline/API Objects</a>
</td>
        </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#pipelines-table"><code><strong>pipelines</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#paused"><code><strong>paused</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#inputs_determined"><code><strong>inputs_determined</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#max_in_flight_reached"><code><strong>max_in_flight_reached</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#interruptible"><code><strong>interruptible</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#jobs-table"><code><strong>jobs</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#builds-table"><code><strong>builds</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resources-table"><code><strong>resources</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#versioned_resources-table"><code><strong>versioned_resources</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resource_types-table"><code><strong>resource_types</strong></code></a></td>
          </tr>
        
      
      
  
    
  

    
      
        <tr>
          <td class="number-cell" align="left">3.2.4.1.2&nbsp;</td>
          <td class="title-cell">
  <a href="database-schema.html#abstract-objects" >Abstract Objects</a>
</td>
        </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resource_configs-table"><code><strong>resource_configs</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resource_caches-table"><code><strong>resource_caches</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resource_cache_uses-table"><code><strong>resource_cache_uses</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#build_image_resource_caches-table"><code><strong>build_image_resource_caches</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#resource_config_check_sessions-table"><code><strong>resource_config_check_sessions</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker_resource_config_check_sessions-table"><code><strong>worker_resource_config_check_sessions</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#base_resource_types-table"><code><strong>base_resource_types</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker_base_resource_types-table"><code><strong>worker_base_resource_types</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker_resource_caches-table"><code><strong>worker_resource_caches</strong></code></a></td>
          </tr>
        
      
      
  
    
  

    
      
        <tr>
          <td class="number-cell" align="left">3.2.4.1.3&nbsp;</td>
          <td class="title-cell">
  <a href="database-schema.html#runtime" >Runtime</a>
</td>
        </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-handle"><code><strong>handle</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-worker_name"><code><strong>worker_name</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-state"><code><strong>state</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-image_check_container_id"><code><strong>image_check_container_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-image_get_container_id"><code><strong>image_get_container_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-build_id"><code><strong>build_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-resource_id"><code><strong>worker_resource_config_check_session_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#containers-table"><code><strong>containers</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-handle"><code><strong>handle</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-worker_name"><code><strong>worker_name</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-state"><code><strong>state</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-container_id"><code><strong>container_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-worker_base_resource_type_id"><code><strong>worker_base_resource_type_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-worker_resource_cache_id"><code><strong>worker_resource_cache_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-worker_task_cache_id"><code><strong>worker_task_cache_id</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#volumes-table"><code><strong>volumes</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker-table-name"><code><strong>name</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker-table-addr"><code><strong>addr</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker-table-state"><code><strong>state</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker-table-baggageclaim-url"><code><strong>baggageclaim_url</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#workers-table"><code><strong>workers</strong></code></a></td>
          </tr>
        
          <tr>
            <td class="number-cell"></td>
            <td class="title-cell"><a href="database-schema.html#worker_task_caches-table"><code><strong>worker_task_caches</strong></code></a></td>
          </tr>
        
      
      
  
    
  

    
  

    </table>
  </div>
</div>

    </div>

    <div class="page-aside"></div>

    <div class="page-content">
      <div class="section" id="section_database-schema">
  
  <h1 class="section-header"><a class="anchor" name="database-schema" href="#database-schema"></a><span class="section-number">3.2.4.1 </span>Database Schema</h1>
  

  

  
    
      <div class="section" id="section_pipelineapi-objects">
  
  <h2 class="section-header"><a class="anchor" name="pipelineapi-objects" href="#pipelineapi-objects"></a>Pipeline/API Objects</h2>
  

  <p>The following tables manage objects exposed directly to users, either via the API or by configuring pipelines.</p><div class="definition">
  <div class="definition-thumb">
    <a name="pipelines-table"></a>
    <pre><a href="database-schema.html#pipelines-table"><strong>pipelines</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>pipelines</em> table contains details about a pipeline; its name, which team it belongs to, whether it is paused, and whether it is public.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="jobs-table"></a>
    <pre><a href="database-schema.html#jobs-table"><strong>jobs</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>jobs</em> table tracks the details of all jobs in a Concourse deployment.  Jobs reference the <a href="database-schema.html#pipelines-table">pipeline</a> they belong to, their <a href="jobs.html">Job</a> configuration, and their name in the pipeline.</p><p>There are also a number of attributes which are used by the runtime:</p><div style="margin: 0 2em 1em" class="inset"><div class="definition">
  <div class="definition-thumb">
    <a name="paused"></a>
    <pre><a href="database-schema.html#paused"><strong>paused</strong></a>: boolean</pre>
  </div>

  <div class="definition-content">
    <p>The build scheduler does not schedule builds for jobs which are <code>paused</code>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="inputs_determined"></a>
    <pre><a href="database-schema.html#inputs_determined"><strong>inputs_determined</strong></a>: boolean</pre>
  </div>

  <div class="definition-content">
    <p>The build scheduler does not schedule builds for jobs which have not yet had their <code>inputs_determined</code>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="max_in_flight_reached"></a>
    <pre><a href="database-schema.html#max_in_flight_reached"><strong>max_in_flight_reached</strong></a>: boolean</pre>
  </div>

  <div class="definition-content">
    <p>The build scheduler does not schedule builds for jobs that have had their build <code>max_in_flight_reached</code>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="interruptible"></a>
    <pre><a href="database-schema.html#interruptible"><strong>interruptible</strong></a>: boolean</pre>
  </div>

  <div class="definition-content">
    <p>Workers trying to <a href="worker-internals.html#worker-lifecycle">land</a> will wait until all builds are finished, unless the build is for an <code>interruptible</code> job.</p>
  </div>
</div></div>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="builds-table"></a>
    <pre><a href="database-schema.html#builds-table"><strong>builds</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>builds</em> table tracks the details of every run of every <a href="database-schema.html#jobs-table">job</a> or <a href="running-tasks.html#fly-execute">one-off build</a>, including its name, the status of the build, whether the build has been scheduled or completed, and information about the start and end times of the build.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="resources-table"></a>
    <pre><a href="database-schema.html#resources-table"><strong>resources</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>An entry in the <em>resources</em> table represents a resource defined in a <a href="pipelines.html">pipeline</a>. The <em>resources</em> table has columns for configuration, name, type, and details about resource version checking.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="versioned_resources-table"></a>
    <pre><a href="database-schema.html#versioned_resources-table"><strong>versioned_resources</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>This table contains versions of <a href="database-schema.html#resources-table">resources</a> discovered by checking.  <em>Versioned resources</em> have attributes describing their version, metadata, resource type, and whether the version is enabled in the pipeline.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="resource_types-table"></a>
    <pre><a href="database-schema.html#resource_types-table"><strong>resource_types</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>An entry in the <em>resource types</em> table represents a custom resource type defined in a pipleine, and all of the information neccessary to pull the image bits for a custom resource type.  This includes the <em>resource type</em> used to fetch the resource type&#39;s image (either a <a href="database-schema.html#base_resource_types-table">base_resource_type</a> or another custom resource) , the version of the image to fetch using that resource, and the configuration of the custom resource type.</p>
  </div>
</div>

  
    
  
</div>
    
      <div class="section" id="section_abstract-objects">
  
  <h2 class="section-header"><a class="anchor" name="abstract-objects" href="#abstract-objects"></a>Abstract Objects</h2>
  

  <p>Concourse&#39;s database manages the abstractions around resources, resource configuration, resource versioning, and resource types. These tables help make the <a href="resources.html">Resources</a> concept operate as expected, scale across many pipelines, and to many different types.</p><div class="definition">
  <div class="definition-thumb">
    <a name="resource_configs-table"></a>
    <pre><a href="database-schema.html#resource_configs-table"><strong>resource_configs</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>resource config</em> is a distinct configuration of a resource type, not specific to any pipeline resource.</p><p>A resource config is used for discovering versions. Unlike <a href="database-schema.html#resources-table">pipeline resources</a>, they have no name, and are identified entirely by their type and source. Resource configs are shared across pipelines and teams, since identical resource configurations can be reused.</p><p>A resource config&#39;s <em>type</em> is either a <a href="database-schema.html#base_resource_types-table">base resource type</a> or, in the case of a custom resource type, the <a href="database-schema.html#resource_caches-table">resource cache</a> of its custom type&#39;s image resource.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="resource_caches-table"></a>
    <pre><a href="database-schema.html#resource_caches-table"><strong>resource_caches</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>resource cache</em> represents all information necessary to fetch a particular set of bits, i.e. the <em>cache</em>.</p><p>A resource cache always points to its <a href="database-schema.html#resource_configs-table"><code><strong>resource_configs</strong></code></a>, and also specifies the <em>version</em> and <em>params</em>.</p><p>Note that <a href="database-schema.html#resource_configs-table"><code><strong>resource_configs</strong></code></a> and <a href="database-schema.html#resource_caches-table"><code><strong>resource_caches</strong></code></a> both point to each other. This loop is closed by a resource config that points to a <a href="database-schema.html#base_resource_types-table">base resource type</a> at the end of the chain. This represents the case of a resource cache provided by a custom resource type, which in turn may be provided by <em>another</em> custom resource type, and so on, until they reach a base type.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="resource_cache_uses-table"></a>
    <pre><a href="database-schema.html#resource_cache_uses-table"><strong>resource_cache_uses</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>cache use</em> is a join table between a <a href="database-schema.html#resource_caches-table">resource cache</a> and a &#39;user&#39;, which lets us know when the use is no longer needed. Think of it as a reference counter.</p><p>A use can be tied to a <a href="database-schema.html#builds-table"><code><strong>builds</strong></code></a>, in which case the use can be removed when the build is finished. A cache is in use by a build when the build is fetching it as an input. This is to prevent the garbage collector from reaping caches that are no longer desired in the long run, but are still in use by a build.</p><p>A use can be tied to a <a href="database-schema.html#containers-table"><code><strong>containers</strong></code></a>, in which case the use can be removed when the container goes away. A cache is in use by a container when it&#39;s being used as the container&#39;s image, either via <a href="tasks.html#image_resource"><code><strong>image_resource</strong></code></a> or a <a href="resource-types.html">resource type</a>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="build_image_resource_caches-table"></a>
    <pre><a href="database-schema.html#build_image_resource_caches-table"><strong>build_image_resource_caches</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>build image resource cache</em> is a join table between a <a href="database-schema.html#builds-table">build</a> and a <a href="database-schema.html#resource_caches-table">resource cache</a>.</p><p>A build image resource cache is used for keeping caches that were used for an <a href="tasks.html#image_resource"><code><strong>image_resource</strong></code></a> in a build, as part of the <a href="caching-and-retention.html#resource-retention">resource retention policy</a>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="resource_config_check_sessions-table"></a>
    <pre><a href="database-schema.html#resource_config_check_sessions-table"><strong>resource_config_check_sessions</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>resource config check session</em> is used for periodic resource checking of <a href="database-schema.html#resources-table"><code><strong>resources</strong></code></a> and <a href="database-schema.html#resource_types-table"><code><strong>resource_types</strong></code></a> by pointing to their <a href="database-schema.html#resource_configs-table">resource config</a>. There is only one check container per resource config, even if it&#39;s defined in many pipelines.</p><p>A check session&#39;s expiry is tied to its worker&#39;s uptime, as a simple way to force balancing of check containers across workers more quickly after a deploy.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker_resource_config_check_sessions-table"></a>
    <pre><a href="database-schema.html#worker_resource_config_check_sessions-table"><strong>worker_resource_config_check_sessions</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>worker resource config check session</em> is a join table tying a <a href="database-schema.html#resource_config_check_sessions-table">resource config check session</a> to a <a href="database-schema.html#worker_base_resource_types-table">worker base resource type</a>. When either go away, the worker resource config check session goes away. This is so that containers using an old base resource type are reaped and recreated.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="base_resource_types-table"></a>
    <pre><a href="database-schema.html#base_resource_types-table"><strong>base_resource_types</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>An entry in the <em>base resource types</em> table represents a resource type which can be provided by any worker. It is used to keep <a href="database-schema.html#resource_configs-table"><code><strong>resource_configs</strong></code></a> as general as possible, and not tied to particular workers. This in turn allows <a href="database-schema.html#resource_caches-table"><code><strong>resource_caches</strong></code></a> to also be general, as is desired for Concourse&#39;s higher-level pipeline resource caching semantics.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker_base_resource_types-table"></a>
    <pre><a href="database-schema.html#worker_base_resource_types-table"><strong>worker_base_resource_types</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>An entry in the <em>worker base resource type</em> table represents a location on a particular worker where the rootFS for a specific version of a <a href="database-schema.html#base_resource_types-table">base_resource_type</a> is found. When a worker registers, its <a href="database-schema.html#base_resource_types-table"><code><strong>base_resource_types</strong></code></a> are synced by first removing old versions and then inserting new ones.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker_resource_caches-table"></a>
    <pre><a href="database-schema.html#worker_resource_caches-table"><strong>worker_resource_caches</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>A <em>worker resource cache</em> is a join between a <a href="database-schema.html#resource_caches-table">resource cache</a> and a <a href="database-schema.html#worker_base_resource_types-table">worker base resource type</a>.</p><p>A worker resource cache is automatically removed when its worker base resource type or resource cache is removed. This is used to automatically invalidate any caches that were fetched with an old version of a base resource type.</p>
  </div>
</div>

  
    
  
</div>
    
      <div class="section" id="section_runtime">
  
  <h2 class="section-header"><a class="anchor" name="runtime" href="#runtime"></a>Runtime</h2>
  

  <div class="definition">
  <div class="definition-thumb">
    <a name="containers-table"></a>
    <pre><a href="database-schema.html#containers-table"><strong>containers</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>containers</em> table represents the set of all containers across all the workers, and keeps track of their state such that no container is ever left behind on a worker.</p><p>Containers have a handful of really important attributes:</p><div style="margin: 0 2em 1em" class="inset"><div class="definition">
  <div class="definition-thumb">
    <a name="containers-handle"></a>
    <pre><a href="database-schema.html#containers-handle"><strong>handle</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The unique identifier of the container in Garden.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="containers-worker_name"></a>
    <pre><a href="database-schema.html#containers-worker_name"><strong>worker_name</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The name of the worker where the container is located.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="containers-state"></a>
    <pre><a href="database-schema.html#containers-state"><strong>state</strong></a>: CREATING, CREATED, or DESTROYING</pre>
  </div>

  <div class="definition-content">
    <p>The stage in the lifecycle of the container. See <a href="container-internals.html#container-lifecycle">Lifecycle</a></p>
  </div>
</div><p>Containers can be one of four types, each with individual references to their relating object.</p><div class="definition">
  <div class="definition-thumb">
    <a name="containers-image_check_container_id"></a>
    <pre><a href="database-schema.html#containers-image_check_container_id"><strong>image_check_container_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>This signifies that the container is dependant on another container which is busy checking for the image this container will be based on. This is used in the case of custom resource types, or tasks with image_resource.  This container will be in the <code>CREATING</code> <a href="database-schema.html#containers-state">state</a> until the image is fetched later.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="containers-image_get_container_id"></a>
    <pre><a href="database-schema.html#containers-image_get_container_id"><strong>image_get_container_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>This signifies that the container is dependant on another container which is busy downloading the bits for the image this container will be based on. This is used in the case of custom resource types, or tasks with image_resource. This container will be in the <code>CREATING</code> <a href="database-schema.html#containers-state">state</a> until the image is fetched.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="containers-build_id"></a>
    <pre><a href="database-schema.html#containers-build_id"><strong>build_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>If this container is for a build step, this column refers to the <a href="database-schema.html#builds-table"><code><strong>builds</strong> (id)</code></a> this container is related to.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="containers-resource_id"></a>
    <pre><a href="database-schema.html#containers-resource_id"><strong>worker_resource_config_check_session_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>If this container is for running the check script for a resource, this column refers to a <a href="database-schema.html#worker_resource_config_check_sessions-table"><code><strong>worker_resource_config_check_sessions</strong> (id)</code></a>.</p>
  </div>
</div></div>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-table"></a>
    <pre><a href="database-schema.html#volumes-table"><strong>volumes</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>volumes</em> table represents the set of all volumes across all the workers, and keeps track of their state such that no volume is ever left behind on a worker.</p><p>Volumes have a handful of really important attributes.</p><div style="margin: 0 2em 1em" class="inset"><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-handle"></a>
    <pre><a href="database-schema.html#volumes-handle"><strong>handle</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The unique identifier of the volume in BaggageClaim.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-worker_name"></a>
    <pre><a href="database-schema.html#volumes-worker_name"><strong>worker_name</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The name of the worker where the volume located.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-state"></a>
    <pre><a href="database-schema.html#volumes-state"><strong>state</strong></a>: CREATING, CREATED, or DESTROYING</pre>
  </div>

  <div class="definition-content">
    <p>The stage in the lifecycle of the volume. See <a href="volume-internals.html">Volumes</a>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-container_id"></a>
    <pre><a href="database-schema.html#volumes-container_id"><strong>container_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>The container this volume is associated with.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-worker_base_resource_type_id"></a>
    <pre><a href="database-schema.html#volumes-worker_base_resource_type_id"><strong>worker_base_resource_type_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>If this volume is used for a <a href="database-schema.html#worker_base_resource_types-table">worker base resource type</a> this column points to it.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-worker_resource_cache_id"></a>
    <pre><a href="database-schema.html#volumes-worker_resource_cache_id"><strong>worker_resource_cache_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>If this volume is for a <a href="database-schema.html#worker_resource_caches-table">worker resource cache</a> this column points to it.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="volumes-worker_task_cache_id"></a>
    <pre><a href="database-schema.html#volumes-worker_task_cache_id"><strong>worker_task_cache_id</strong></a>: fkey</pre>
  </div>

  <div class="definition-content">
    <p>If this volume is for a <a href="database-schema.html#worker_task_caches-table">worker task cache</a> this column points to it.</p>
  </div>
</div></div>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="workers-table"></a>
    <pre><a href="database-schema.html#workers-table"><strong>workers</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>workers</em> table represents all of the workers that have registered with the Concourse cluster.</p><div style="margin: 0 2em 1em" class="inset"><div class="definition">
  <div class="definition-thumb">
    <a name="worker-table-name"></a>
    <pre><a href="database-schema.html#worker-table-name"><strong>name</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The unique name for the worker used to identify it in the cluster.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker-table-addr"></a>
    <pre><a href="database-schema.html#worker-table-addr"><strong>addr</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The full address of the Garden server running for the worker.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker-table-state"></a>
    <pre><a href="database-schema.html#worker-table-state"><strong>state</strong></a>: RUNNING, STALLED, LANDING, LANDED, RETIRING</pre>
  </div>

  <div class="definition-content">
    <p>The current state of the worker. This keeps track of the worker&#39;s lifecycle in order to handle the lifecycle of workers and their ability to have new containers or volumes created on them.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker-table-baggageclaim-url"></a>
    <pre><a href="database-schema.html#worker-table-baggageclaim-url"><strong>baggageclaim_url</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p>The full address of the worker&#39;s baggageclaim server; used to store volumes on the worker.</p>
  </div>
</div></div>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="worker_task_caches-table"></a>
    <pre><a href="database-schema.html#worker_task_caches-table"><strong>worker_task_caches</strong></a></pre>
  </div>

  <div class="definition-content">
    <p>The <em>worker task caches</em> table tracks all of the details of a <a href="tasks.html#caches">task cache</a> for a specific worker. <em>Worker task caches</em> are created for any <a href="task-step.html"><code>task</code> step</a> in a job for all of the paths specified <a href="tasks.html#caches">task cache</a>.</p><p>This table is used to identify worker task cache volumes by their <a href="database-schema.html#volumes-worker_task_cache_id">id</a>.</p>
  </div>
</div>

  
    
  
</div>
    
  
</div>

      <nav class="prev-next">
      
        <div class="prev">
          prev:

          

          <a href="architecture.html#internals">Internals</a>
        </div>
      

      
        <div class="next">
          next:

          
          <span class="section-number">3.2.4.2</span>
          

          <a href="garbage-collection.html">Garbage Collection</a>
        </div>
      
      </nav>
    </div>

    <ul class="improve-docs">
      <li><img src="images/github.svg" /> <a href="https://github.com/concourse/docs">help improve this site</a></li>
      <li><img src="images/booklit.svg" /> powered by <a href="https://vito.github.io/booklit">Booklit</a></li>
    </ul>
  </body>
</html>